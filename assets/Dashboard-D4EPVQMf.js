import{j as e,a as z,U as C}from"./index--b10zKEF.js";import{r as x,d as T,L as j}from"./react-vendor-wpuS94OW.js";import{w as N}from"./WalletService-Dz-hmYOq.js";import{W as L}from"./WalletModal-Cw6u5lQQ.js";import{p as M,P as D}from"./PostCard-B5FWFnvd.js";import{m as g,A as I}from"./animation-vendor-DcM-v-LS.js";import{S as B}from"./shield-check-B7t6Kk0y.js";import{P as W}from"./ParticlesBackground-DMR5guET.js";import{F as V,z as y}from"./index-CNUiO53a.js";import{c as q,q as f,w as p,o as w,l as k,s as $,g as E,u as _,d as O,a as A,b as R}from"./firebase-CrKjQ57N.js";import{B as F}from"./bell-vmLsXsdZ.js";import{X as G}from"./x-ByfO-DNc.js";import"./index-B9ygI19o.js";import"./user-Crfu7g3f.js";import"./lock-BbG5lLOB.js";import"./share-2-C4AXdlKf.js";const P=({daysAgo:l=0,maxPosts:r=10})=>{const[t,i]=x.useState([]),[s,n]=x.useState(!0);return x.useEffect(()=>{n(!0);const c=M.subscribeToPostsByRange(l,r,d=>{i(d),n(!1)});return()=>c()},[l,r]),s?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-[var(--accent)]/10 border-t-[var(--accent)] rounded-full animate-spin"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center animate-pulse",children:e.jsx("div",{className:"w-2 h-2 bg-[var(--accent)] rounded-full"})})]}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-[var(--accent)] animate-pulse",children:"Synchronizing Data..."})]}):t.length===0?e.jsxs(g.div,{initial:{opacity:0},animate:{opacity:1},className:"p-12 text-center rounded-[2rem] bg-black/40 border border-dashed border-[var(--accent)]/20 backdrop-blur-3xl overflow-hidden relative",children:[e.jsx("div",{className:"absolute inset-0 bg-[repeating-linear-gradient(45deg,transparent,transparent_10px,rgba(0,255,194,0.02)_10px,rgba(0,255,194,0.02)_20px)] pointer-events-none"}),e.jsx("div",{className:"w-14 h-14 bg-[var(--accent)]/10 rounded-2xl flex items-center justify-center mx-auto mb-4 border border-[var(--accent)]/20 shadow-[0_0_15px_rgba(0,255,194,0.05)]",children:e.jsx(B,{className:"w-7 h-7 text-[var(--accent)]/40"})}),e.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-[var(--accent)]/60",children:"Uplink Silent"}),e.jsx("p",{className:"text-[10px] text-[var(--text-secondary)] font-bold uppercase tracking-tighter mt-1",children:"Fragment_ID: Zero_Detected"})]}):e.jsx("div",{className:"space-y-6",children:e.jsx(I,{mode:"popLayout",children:t.map((c,d)=>e.jsx(D,{post:c,index:d},c.id))})})};class X{notificationsCollection=q(R,"notifications");async getNotifications(r,t=20,i){try{let s=f(this.notificationsCollection,p("userId","==",r),w("createdAt","desc"),k(t));i&&(s=f(this.notificationsCollection,p("userId","==",r),w("createdAt","desc"),$(i),k(t)));const n=await E(s),c=n.docs.map(h=>({id:h.id,...h.data()})),d=n.docs[n.docs.length-1]||null,v=n.docs.length===t;return{notifications:c,lastDoc:d,hasMore:v}}catch(s){return console.error("Error getting notifications:",s),{notifications:[],lastDoc:null,hasMore:!1}}}async getUnreadCount(r){try{const t=f(this.notificationsCollection,p("userId","==",r),p("read","==",!1));return(await E(t)).size}catch(t){return console.error("Error getting unread count:",t),0}}async markAsRead(r){try{const t=r.map(i=>_(O(this.notificationsCollection,i),{read:!0}));await Promise.all(t)}catch(t){throw console.error("Error marking notifications as read:",t),new Error("Failed to mark notifications as read")}}async markAllAsRead(r){try{const t=f(this.notificationsCollection,p("userId","==",r),p("read","==",!1)),s=(await E(t)).docs.map(n=>_(n.ref,{read:!0}));await Promise.all(s)}catch(t){throw console.error("Error marking all as read:",t),new Error("Failed to mark all notifications as read")}}listenToNotifications(r,t){const i=f(this.notificationsCollection,p("userId","==",r),w("createdAt","desc"),k(10));return A(i,s=>{const n=s.docs.map(c=>({id:c.id,...c.data()}));t(n)},s=>{console.error("Error listening to notifications:",s),t([])})}listenToUnreadCount(r,t){const i=f(this.notificationsCollection,p("userId","==",r),p("read","==",!1));return A(i,s=>{t(s.size)},s=>{console.error("Error listening to unread count:",s),t(0)})}}const S=new X,U=()=>{const{user:l}=z(),r=T(),[t,i]=x.useState(0),[s,n]=x.useState([]),[c,d]=x.useState(!1);x.useEffect(()=>{if(!l)return;const a=S.listenToUnreadCount(l.id,m=>{i(m)}),b=S.listenToNotifications(l.id,m=>{n(m)});return()=>{a(),b()}},[l]);const v=async a=>{a.read||await S.markAsRead([a.id]),a.actionUrl&&r(a.actionUrl),d(!1)},h=a=>{switch(a){case"match_invite":case"match_accepted":return"ðŸŽ®";case"match_result":return"ðŸ†";case"coin_transaction":return"ðŸ’°";case"tournament_joined":return"ðŸŽ¯";default:return"ðŸ“¢"}},o=a=>{const b=new Date,m=new Date(a),u=Math.floor((b.getTime()-m.getTime())/1e3);return u<60?"Just now":u<3600?`${Math.floor(u/60)}m ago`:u<86400?`${Math.floor(u/3600)}h ago`:`${Math.floor(u/86400)}d ago`};return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>d(!c),className:"relative p-2 rounded-lg hover:bg-[var(--glass)] transition-colors",children:[e.jsx(F,{className:"w-5 h-5 text-[var(--text-primary)]"}),t>0&&e.jsx(g.span,{initial:{scale:0},animate:{scale:1},className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center",children:t>9?"9+":t})]}),e.jsx(I,{children:c&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>d(!1)}),e.jsxs(g.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute right-0 top-full mt-2 w-80 max-h-96 bg-[var(--bg-primary)] border border-[var(--border)] rounded-xl shadow-2xl overflow-hidden z-50",children:[e.jsxs("div",{className:"p-4 border-b border-[var(--border)] flex justify-between items-center bg-[var(--glass)]",children:[e.jsx("h3",{className:"font-bold text-sm",children:"Notifications"}),e.jsx("button",{onClick:()=>d(!1),className:"p-1 hover:bg-[var(--glass)] rounded",children:e.jsx(G,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"overflow-y-auto max-h-80 custom-scrollbar",children:s.length===0?e.jsxs("div",{className:"p-8 text-center text-[var(--text-secondary)]",children:[e.jsx(F,{className:"w-12 h-12 mx-auto mb-2 opacity-30"}),e.jsx("p",{className:"text-sm",children:"No notifications yet"})]}):s.map(a=>e.jsx("button",{onClick:()=>v(a),className:`w-full p-4 border-b border-[var(--border)] hover:bg-[var(--glass)] transition-colors text-left ${a.read?"":"bg-[var(--accent)]/5"}`,children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("span",{className:"text-2xl",children:h(a.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-bold text-[var(--text-primary)] mb-1",children:a.title}),e.jsx("p",{className:"text-xs text-[var(--text-secondary)] line-clamp-2 mb-1",children:a.message}),e.jsx("p",{className:"text-xs text-[var(--text-secondary)] opacity-60",children:o(a.createdAt)})]}),!a.read&&e.jsx("div",{className:"w-2 h-2 bg-[var(--accent)] rounded-full mt-1"})]})},a.id))}),s.length>0&&e.jsx("div",{className:"p-3 border-t border-[var(--border)] bg-[var(--glass)]",children:e.jsx("button",{onClick:()=>{r("/notifications"),d(!1)},className:"text-xs text-[var(--accent)] hover:underline w-full text-center",children:"View All Notifications"})})]})]})})]})},de=()=>{const{user:l}=z(),[r,t]=x.useState(null),[i,s]=x.useState(!0),[n,c]=x.useState(null);x.useEffect(()=>{if(!l)return;(async()=>{const b=await N.getWallet(l.id);t(b),s(!1)})();const a=b=>{const m=b.detail;m&&t(m)};return window.addEventListener("walletUpdate",a),()=>window.removeEventListener("walletUpdate",a)},[l]);const d=async o=>{if(l)try{if(n==="add")await N.addFunds(o,l.id),y.success(`â‚¹${o.toLocaleString("en-IN")} added successfully!`,{icon:"ðŸ’°",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(16px)",border:"1px solid rgba(0, 255, 194, 0.3)",color:"#fff"}});else if(n==="withdraw"){const a={method:"bank",accountNumber:"XXXX"};await N.withdrawFunds(o,l.id,a),y.success(`â‚¹${o.toLocaleString("en-IN")} withdrawn successfully!`,{icon:"âœ…",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(16px)",border:"1px solid rgba(0, 255, 194, 0.3)",color:"#fff"}})}}catch(a){throw y.error(a instanceof Error?a.message:"Transaction failed",{icon:"âŒ",style:{background:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(16px)",border:"1px solid rgba(255, 75, 43, 0.3)",color:"#fff"}}),a}};if(i)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[var(--bg-primary)]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[var(--accent)]"})});const v=[{id:"freefire",name:"Free Fire",players:"1.2M",gradient:"from-red-500/20 to-orange-500/20"},{id:"bgmi",name:"BGMI",players:"2.5M",gradient:"from-orange-500/20 to-yellow-600/20"},{id:"valorant",name:"Valorant",players:"800K",gradient:"from-red-600/20 to-pink-500/20"},{id:"minecraft",name:"Minecraft",players:"500K",gradient:"from-purple-500/20 to-indigo-500/20"}],h=[{icon:"âœï¸",label:"Social Hub",route:"/social"},{icon:"ðŸŽ®",label:"Play Games",route:"/play"},{icon:"ðŸŽ²",label:"Color Prediction",route:"/predict"},{icon:"ðŸ†",label:"Tournaments",route:"/tournaments"},{icon:"ðŸ’¬",label:"Support",route:"/support"},{icon:"âš™ï¸",label:"Settings",route:"/profile"}];return e.jsxs(g.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"h-[100dvh] overflow-hidden flex flex-col lg:flex-row bg-[var(--bg-primary)] text-[var(--text-primary)] font-sans selection:bg-[var(--accent)]/30 selection:text-[var(--accent)] transition-colors duration-300",children:[e.jsx(V,{position:"top-right"}),e.jsx(W,{}),e.jsxs("div",{className:"lg:hidden p-4 flex justify-between items-center bg-[var(--bg-primary)]/90 backdrop-blur-xl border-b border-[var(--border)] z-20 sticky top-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-[var(--accent)] to-[#7c3aed] bg-clip-text text-transparent italic",children:"ESPO V2"}),e.jsxs("p",{className:"text-sm text-[var(--text-secondary)] mt-0.5",children:["Welcome ",l?.firstName||"Gamer"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(U,{}),e.jsxs("div",{className:"flex flex-col items-end mr-2",children:[e.jsx("span",{className:"text-[10px] text-[var(--text-secondary)] uppercase",children:"Balance"}),e.jsxs("span",{className:"text-sm font-bold text-[var(--accent)]",children:["â‚¹",r?.balance.toLocaleString()]})]}),e.jsx(C,{afterSignOutUrl:"/"})]})]}),e.jsxs("div",{className:"hidden lg:flex flex-col w-64 p-6 border-r border-[var(--border)] bg-[var(--bg-primary)]/50 backdrop-blur-xl h-full z-10",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-[var(--accent)] to-[#7c3aed] bg-clip-text text-transparent italic tracking-tighter",children:"ESPO V2"}),e.jsx("p",{className:"text-xs text-[var(--text-secondary)] mt-1 uppercase tracking-widest",children:"Command Center"})]}),e.jsx("nav",{className:"flex-1 space-y-2",children:h.map(o=>e.jsxs(j,{to:o.route,className:"flex items-center gap-3 px-4 py-3 rounded-lg text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--glass)] transition-all group relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-[var(--accent)]/5 translate-x-[-100%] group-hover:translate-x-0 transition-transform duration-300"}),e.jsx("span",{className:"text-xl group-hover:scale-110 transition-transform relative z-10",children:o.icon}),e.jsx("span",{className:"text-sm font-medium relative z-10",children:o.label})]},o.route))}),e.jsx("div",{className:"mt-auto pt-6 border-t border-[var(--border)]",children:e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 rounded-lg bg-[var(--glass)] border border-[var(--border)]",children:[e.jsx(C,{afterSignOutUrl:"/"}),e.jsxs("div",{className:"flex-1 overflow-hidden",children:[e.jsx("p",{className:"text-sm font-bold truncate",children:l?.fullName||"Gamer"}),e.jsx("p",{className:"text-[10px] text-[var(--text-secondary)] truncate",children:l?.primaryEmailAddress?.emailAddress})]})]})})]}),e.jsxs("div",{className:"flex-1 flex flex-col h-full overflow-hidden relative z-0",children:[e.jsxs("header",{className:"hidden lg:flex h-16 px-8 items-center justify-between border-b border-[var(--border)] bg-[var(--bg-primary)]/50 backdrop-blur-sm z-10",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("h2",{className:"text-xl font-bold",children:["Welcome back, ",l?.firstName||"Gamer","!"]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(U,{}),e.jsx(j,{to:"/social",className:"px-5 py-2 rounded-lg bg-[var(--accent)] text-[var(--bg-primary)] text-sm font-bold hover:bg-[var(--accent)]/90 transition-all hover:scale-105 shadow-[0_0_20px_rgba(0,255,194,0.3)]",children:"+ Intelligence Nexus"})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 pb-24 lg:p-8 custom-scrollbar scroll-smooth overscroll-contain",children:[e.jsxs(g.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},whileHover:{scale:1.01},className:"w-full h-56 lg:h-64 rounded-2xl relative overflow-hidden mb-8 group cursor-pointer border border-[var(--border)] shadow-2xl bg-[var(--bg-primary)]",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-[#7c3aed] to-[var(--accent)] opacity-80 mix-blend-overlay"}),e.jsx("div",{className:"absolute inset-0 bg-[url('https://images.unsplash.com/photo-1542751371-adc38448a05e?q=80&w=2670&auto=format&fit=crop')] bg-cover bg-center opacity-40 group-hover:scale-110 transition-transform duration-1000"}),e.jsx("div",{className:"absolute bottom-0 left-0 p-6 lg:p-8 z-10 w-full bg-gradient-to-t from-black/80 to-transparent",children:e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsx("span",{className:"px-3 py-1 rounded-full bg-white/10 backdrop-blur-md border border-white/20 text-[10px] lg:text-xs font-bold mb-3 inline-block text-[var(--accent)]",children:"FEATURED EVENT"}),e.jsx("h2",{className:"text-2xl lg:text-4xl font-bold mb-2",children:"Summer Championship"}),e.jsx("p",{className:"text-gray-200 text-sm lg:text-base max-w-lg mb-4 line-clamp-1 lg:line-clamp-none",children:"Join the ultimate battle royale experience. Prize pool â‚¹1,00,000."})]}),e.jsx("button",{className:"hidden lg:block px-6 py-2 bg-white text-black font-bold rounded-lg hover:bg-gray-200 transition-colors",children:"Join Now"})]})})]}),e.jsxs("div",{className:"mb-10",children:[e.jsxs("h3",{className:"text-xl font-black mb-6 flex items-center gap-3",children:[e.jsx("span",{className:"w-1.5 h-8 bg-[var(--accent)] rounded-full shadow-[0_0_15px_var(--accent)]"}),"EXPLORE GAMES"]}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 lg:gap-4",children:v.map((o,a)=>e.jsx(j,{to:`/tournaments/${o.id}`,className:"group block",children:e.jsxs(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:a*.1},whileHover:{y:-4},className:"relative aspect-[3/4] rounded-xl overflow-hidden border border-[#00ffc2]/20 bg-[rgba(255,255,255,0.03)] hover:border-[#00ffc2] transition-all duration-300 shadow-lg group-hover:shadow-[0_0_20px_rgba(0,255,194,0.3)] backdrop-blur-[16px]",style:{backdropFilter:"blur(16px)"},children:[e.jsx("img",{src:`https://cdn.jsdelivr.net/gh/Vishalxsuman/Esporizon-v2@main/Images/${o.id}.png`,alt:o.name,className:"absolute inset-0 w-full h-full object-cover opacity-40 group-hover:opacity-60 transition-opacity",onError:b=>{const m=b.target;m.style.display="none"}}),e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${o.gradient} opacity-30 group-hover:opacity-50 transition-opacity`}),e.jsxs("div",{className:"absolute top-3 right-3 flex items-center gap-1.5 bg-[#ff4b2b] px-2.5 py-1.5 rounded-full",style:{animation:"breathe 2s ease-in-out infinite"},children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-white animate-pulse"}),e.jsx("span",{className:"text-[10px] font-bold text-white uppercase tracking-wide",children:o.players})]}),e.jsx("div",{className:"absolute bottom-0 left-0 w-full p-4 bg-gradient-to-t from-black/90 via-black/60 to-transparent",children:e.jsx("h4",{className:"text-base lg:text-xl font-bold group-hover:text-[var(--accent)] transition-colors drop-shadow-lg",children:o.name})})]})},o.id))})]}),e.jsxs("div",{className:"lg:hidden mb-12",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-xl font-black flex items-center gap-3",children:[e.jsx("span",{className:"w-1.5 h-8 bg-[#7c3aed] rounded-full shadow-[0_0_15px_#7c3aed]"}),"LIVE FEED"]}),e.jsx(j,{to:"/social",className:"text-xs text-[var(--accent)]",children:"View All"})]}),e.jsx("div",{className:"space-y-4",children:e.jsx(P,{maxPosts:3})})]})]})]}),e.jsxs("div",{className:"hidden xl:flex flex-col w-80 h-full border-l border-[var(--border)] bg-[var(--bg-primary)]/30 backdrop-blur-sm z-10 relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 w-[1px] bg-gradient-to-b from-transparent via-[var(--border)] to-transparent"}),e.jsx("div",{className:"p-6 border-b border-[var(--border)]",children:e.jsxs("div",{className:"p-5 rounded-2xl bg-gradient-to-br from-[var(--glass-intense)] to-transparent border border-[var(--border)] relative overflow-hidden group hover:border-[var(--accent)]/30 transition-all",children:[e.jsx("div",{className:"absolute -right-10 -top-10 w-32 h-32 bg-[var(--accent)]/10 rounded-full blur-2xl group-hover:bg-[var(--accent)]/20 transition-all"}),e.jsx("p",{className:"text-xs text-[var(--text-secondary)] mb-1 uppercase tracking-wider font-bold",children:"Total Balance"}),e.jsxs("h2",{className:"text-4xl font-black text-[var(--text-primary)] mb-6 tracking-tight",children:["â‚¹",r?.balance.toLocaleString("en-IN")||"0"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>c("add"),className:"flex-1 py-2.5 rounded-lg bg-[var(--accent)] hover:bg-[var(--accent)]/90 text-[var(--bg-primary)] text-xs font-bold transition-all shadow-lg shadow-[var(--accent)]/20 hover:scale-105 active:scale-95",children:"+ Add Funds"}),e.jsx("button",{onClick:()=>c("withdraw"),className:"flex-1 py-2.5 rounded-lg bg-[var(--glass)] hover:bg-[var(--glass-intense)] text-[var(--text-primary)] text-xs font-bold border border-[var(--border)] transition-all hover:border-[var(--text-secondary)]/30",children:"Withdraw"})]})]})}),e.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"px-6 py-4 flex justify-between items-end border-b border-[var(--border)] bg-[var(--glass)]",children:[e.jsx("h3",{className:"font-bold text-[var(--text-secondary)]",children:"Social Feed"}),e.jsx(j,{to:"/social",className:"text-xs text-[var(--accent)] hover:underline hover:text-[var(--accent)]/80 transition-colors",children:"View All"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6 space-y-4 custom-scrollbar",children:e.jsx(P,{maxPosts:5})})]})]}),e.jsx(L,{isOpen:n!==null,onClose:()=>c(null),type:n||"add",currentBalance:r?.balance||0,onSubmit:d})]})};export{de as default};
