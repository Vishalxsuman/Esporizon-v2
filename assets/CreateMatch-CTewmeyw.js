import{a as M,j as e}from"./index--b10zKEF.js";import{d as B,f as L,r as o}from"./react-vendor-wpuS94OW.js";import{f as i,i as l,m as W}from"./espoCoin-CHE-5TF3.js";import{w as N}from"./WalletService-Dz-hmYOq.js";import{z as h}from"./index-CNUiO53a.js";import{A}from"./arrow-left-DXLZyVYx.js";import{G as z}from"./globe-DOQG9IxB.js";import{L as G}from"./lock-BbG5lLOB.js";import{U as T}from"./users-BZz0W578.js";import"./animation-vendor-DcM-v-LS.js";import"./firebase-CrKjQ57N.js";import"./index-B9ygI19o.js";const Q=()=>{const p=B(),{user:t}=M(),[f]=L(),d=f.get("game")||"chess",a=f.get("mode")||"free",[c,w]=o.useState(null),[x,v]=o.useState("public"),[j,C]=o.useState(!1),[r,k]=o.useState(0),[u,P]=o.useState(600),[y,b]=o.useState(!1),g=d==="chess"?"Chess":"29 Card Game",m=d==="chess"?2:4,E=[10,50,100,500];o.useEffect(()=>{if(!t)return;(async()=>{const n=await N.getWallet(t.id);w(n)})()},[t]);const F=async()=>{if(t){b(!0);try{const s=a==="paid"?l(r):0;if(a==="paid"&&c&&c.espoCoins<s){h.error("Insufficient Espo Coins!"),b(!1);return}a==="paid"&&s>0&&await N.deductEspoCoins(s,t.id,`Entry fee for ${g} match`,{matchType:a});const n=await W.createMatch({gameId:d,mode:a,visibility:x,entryFee:s,maxPlayers:m,withBots:j,timeControl:u},t.id,t.fullName||t.firstName||"Player",t.imageUrl);h.success("Match created!"),p(`/play/match/${n.id}`)}catch(s){console.error("Error creating match:",s),h.error(s instanceof Error?s.message:"Failed to create match")}finally{b(!1)}}},S=()=>{const n=l(r)*m,$=n*.1;return n-$};return e.jsx("div",{className:"min-h-screen bg-[var(--bg-primary)] text-[var(--text-primary)] pb-24 lg:pb-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("button",{onClick:()=>p("/play"),className:"flex items-center gap-2 text-[var(--text-secondary)] hover:text-[var(--text-primary)] mb-4",children:[e.jsx(A,{className:"w-5 h-5"}),"Back to Play"]}),e.jsx("h1",{className:"text-3xl font-black mb-2",children:"Create Match"}),e.jsxs("p",{className:"text-[var(--text-secondary)]",children:[g," â€¢ ",a==="free"?"Free Play":"Paid Play"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-3",children:"Match Visibility"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>v("public"),className:`p-4 rounded-xl border-2 transition-all ${x==="public"?"border-[var(--accent)] bg-[var(--accent)]/10":"border-[var(--border)] hover:border-[var(--accent)]/30"}`,children:[e.jsx(z,{className:"w-6 h-6 mb-2 mx-auto"}),e.jsx("p",{className:"font-bold text-sm",children:"Public Lobby"}),e.jsx("p",{className:"text-xs text-[var(--text-secondary)] mt-1",children:"Anyone can join"})]}),e.jsxs("button",{onClick:()=>v("private"),className:`p-4 rounded-xl border-2 transition-all ${x==="private"?"border-[var(--accent)] bg-[var(--accent)]/10":"border-[var(--border)] hover:border-[var(--accent)]/30"}`,children:[e.jsx(G,{className:"w-6 h-6 mb-2 mx-auto"}),e.jsx("p",{className:"font-bold text-sm",children:"Private Invite"}),e.jsx("p",{className:"text-xs text-[var(--text-secondary)] mt-1",children:"Share link to invite"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-3",children:"Time Control"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:[300,600,1800,3600].map(s=>e.jsxs("button",{onClick:()=>P(s),className:`p-3 rounded-xl border transition-all text-sm font-bold ${u===s?"border-[var(--accent)] bg-[var(--accent)]/10 text-[var(--accent)]":"border-[var(--border)] hover:border-[var(--accent)]/30"}`,children:[s/60,"m"]},s))})]})]}),a==="free"&&e.jsx("div",{className:"p-4 bg-[var(--glass)] rounded-lg border border-[var(--border)]",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-bold flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:"ðŸ¤–"}),d==="chess"?"Play vs Computer":"Allow Bots"]}),e.jsx("p",{className:"text-sm text-[var(--text-secondary)] mt-1",children:d==="chess"?"Challenge our chess engine":"Fill empty slots with bots"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:j,onChange:s=>C(s.target.checked)}),e.jsx("div",{className:"w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-[var(--accent)]"})]})]})}),a==="paid"&&e.jsxs("div",{className:"p-4 bg-yellow-500/10 border border-yellow-500/30 rounded-lg flex items-start gap-3 mb-6",children:[e.jsx("span",{className:"text-xl",children:"âš ï¸"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-yellow-400",children:"Real Players Only"}),e.jsx("p",{className:"text-xs text-[var(--text-secondary)] mt-1",children:"Bots are strictly forbidden in paid matches."})]})]}),a==="paid"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-3",children:"Entry Amount"}),e.jsx("div",{className:"grid grid-cols-4 gap-2 mb-3",children:E.map(s=>e.jsxs("button",{onClick:()=>k(s),className:`py-3 rounded-lg font-bold transition-all ${r===s?"bg-[var(--accent)] text-[var(--bg-primary)]":"bg-[var(--glass)] border border-[var(--border)] hover:border-[var(--accent)]"}`,children:["â‚¹",s]},s))}),e.jsxs("div",{className:"p-4 bg-[var(--glass)] rounded-lg border border-[var(--border)]",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-[var(--text-secondary)]",children:"Entry Fee (You)"}),e.jsx("span",{className:"font-bold",children:i(l(r))})]}),e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-[var(--text-secondary)]",children:"Prize Pool"}),e.jsx("span",{className:"font-bold",children:i(l(r)*m)})]}),e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-[var(--text-secondary)]",children:"Platform Fee (10%)"}),e.jsxs("span",{className:"font-bold text-red-400",children:["-",i(l(r)*m*.1)]})]}),e.jsx("div",{className:"border-t border-[var(--border)] mt-2 pt-2",children:e.jsxs("div",{className:"flex justify-between text-base",children:[e.jsx("span",{className:"font-bold",children:"Winner Gets"}),e.jsx("span",{className:"font-black text-[var(--accent)]",children:i(S())})]})})]}),c&&e.jsxs("div",{className:"mt-3 p-3 bg-[var(--glass)] rounded-lg border border-[var(--border)] flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-[var(--text-secondary)]",children:"Your Balance"}),e.jsx("span",{className:`font-bold ${c.espoCoins>=l(r)?"text-[var(--accent)]":"text-red-400"}`,children:i(c.espoCoins)})]})]}),e.jsxs("div",{className:"p-4 bg-[var(--glass)] rounded-lg border border-[var(--border)]",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(T,{className:"w-4 h-4 text-[var(--text-secondary)]"}),e.jsx("span",{className:"text-sm text-[var(--text-secondary)]",children:"Players"})]}),e.jsxs("p",{className:"font-bold",children:[m," Players"]})]}),e.jsx("button",{onClick:F,disabled:y||a==="paid"&&(r===0||!c||c.espoCoins<l(r)),className:"w-full py-4 bg-[var(--accent)] text-[var(--bg-primary)] font-black rounded-xl hover:bg-[var(--accent)]/90 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-[0_0_30px_rgba(0,255,194,0.3)]",children:y?"Creating...":a==="paid"?`Lock ${i(l(r))} & Create Match`:"Create Free Match"})]})})};export{Q as default};
