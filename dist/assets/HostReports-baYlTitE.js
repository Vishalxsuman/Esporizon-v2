import{k as c,j as e,z as p}from"./index-BI1Zh8jC.js";import{d as R,r as l}from"./react-vendor-wpuS94OW.js";import{A as S}from"./arrow-left-CF79Ni4S.js";import{M as C}from"./message-square-BC04dgYS.js";import{m as k}from"./animation-vendor-DcM-v-LS.js";import{C as F}from"./clock-BatA4oMZ.js";import{S as E}from"./send-BLDoqAZd.js";import{C as _}from"./circle-check-big-CvadS6Gn.js";class ${async createReport(r){try{return(await c.post("/api/reports",r)).data}catch(a){const n=a.response?.data?.message||"Failed to create report";throw new Error(n)}}async getReportsForHost(r,a=1,n=20){try{const o={page:a,limit:n};return r&&(o.status=r),(await c.get("/api/reports/host",{params:o})).data}catch{throw new Error("Failed to fetch reports")}}async getReportsForPlayer(r,a=1,n=20){try{const o={page:a,limit:n};return r&&(o.status=r),(await c.get("/api/reports/player",{params:o})).data}catch{throw new Error("Failed to fetch reports")}}async getReportDetails(r){try{return(await c.get(`/api/reports/${r}`)).data}catch{throw new Error("Failed to fetch report details")}}async addReply(r,a){try{return(await c.post(`/api/reports/${r}/reply`,{message:a})).data}catch(n){const o=n.response?.data?.message||"Failed to add reply";throw new Error(o)}}async updateStatus(r,a){try{return(await c.patch(`/api/reports/${r}/status`,{status:a})).data}catch(n){const o=n.response?.data?.message||"Failed to update status";throw new Error(o)}}}const x=new $,U=()=>{const u=R(),[r,a]=l.useState([]),[n,o]=l.useState(!0),[t,i]=l.useState(null),[d,b]=l.useState(""),[m,N]=l.useState(""),[g,y]=l.useState(!1);l.useEffect(()=>{h()},[m]);const h=async()=>{try{o(!0);const s=await x.getReportsForHost(m);a(s.reports)}catch{a([])}finally{o(!1)}},f=async()=>{if(!(!t||!d.trim()))try{y(!0),await x.addReply(t._id,d),p.success("Reply sent"),b("");const s=await x.getReportDetails(t._id);i(s.report),h()}catch(s){p.error(s.message||"Failed to send reply")}finally{y(!1)}},v=async()=>{if(t)try{await x.updateStatus(t._id,"resolved"),p.success("Report marked as resolved"),i(null),h()}catch(s){p.error(s.message||"Failed to update status")}},j=s=>{switch(s){case"open":return"text-yellow-500 border-yellow-500/30 bg-yellow-500/10";case"in_progress":return"text-blue-500 border-blue-500/30 bg-blue-500/10";case"resolved":return"text-green-500 border-green-500/30 bg-green-500/10";case"closed":return"text-gray-500 border-gray-500/30 bg-gray-500/10";default:return"text-gray-500 border-gray-500/30 bg-gray-500/10"}},w=s=>s.replace("_"," ").toUpperCase();return e.jsx("div",{className:"min-h-screen bg-black text-white py-8 px-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("button",{onClick:()=>u("/host/dashboard"),className:"p-2 bg-zinc-900 rounded-full hover:bg-zinc-800 transition-colors",children:e.jsx(S,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-black italic",children:"Player Reports"}),e.jsx("p",{className:"text-zinc-400 text-sm",children:"Manage disputes and issues"})]})]}),t?e.jsxs("div",{className:"animate-fadeIn",children:[e.jsxs("div",{className:"bg-zinc-900/80 p-5 rounded-xl border border-white/10 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`px-3 py-1 text-xs font-bold rounded-full border ${j(t.status)}`,children:t.status.toUpperCase()}),e.jsx("span",{className:"text-xs text-zinc-500",children:w(t.issueType)})]}),e.jsx("button",{onClick:()=>i(null),className:"text-zinc-500 hover:text-white text-sm font-bold",children:"Back to List"})]}),e.jsx("h2",{className:"font-bold text-xl mb-2",children:t.subject}),e.jsxs("p",{className:"text-sm text-zinc-400",children:[t.tournamentId?.title," • Player: ",t.playerName]})]}),e.jsx("div",{className:"bg-zinc-900/40 border border-white/5 rounded-xl overflow-hidden mb-6",children:e.jsx("div",{className:"max-h-[60vh] overflow-y-auto p-5 space-y-4",children:t.messages?.map((s,z)=>e.jsx("div",{className:`flex ${s.senderType==="host"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[70%] rounded-2xl p-4 ${s.senderType==="host"?"bg-teal-500/20 border border-teal-500/30":"bg-zinc-800/50 border border-white/10"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xs font-bold capitalize",children:s.senderName}),e.jsx("span",{className:"text-[10px] text-zinc-500",children:new Date(s.timestamp).toLocaleString()})]}),e.jsx("p",{className:"text-sm",children:s.message})]})},z))})}),t.status!=="resolved"&&t.status!=="closed"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-3 mb-4",children:[e.jsx("input",{type:"text",value:d,onChange:s=>b(s.target.value),onKeyPress:s=>s.key==="Enter"&&f(),placeholder:"Type your reply...",className:"flex-1 px-5 py-3 bg-zinc-900 border border-white/10 rounded-xl focus:outline-none focus:border-white/20 transition-all text-white placeholder:text-gray-600"}),e.jsxs("button",{onClick:f,disabled:!d.trim()||g,className:"px-6 py-3 bg-teal-500 hover:bg-teal-400 text-black font-bold rounded-xl disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4"}),g?"Sending...":"Send"]})]}),e.jsxs("button",{onClick:v,className:"w-full py-3 bg-green-500/20 border border-green-500/30 text-green-400 hover:bg-green-500/30 font-bold rounded-xl transition-all flex items-center justify-center gap-2",children:[e.jsx(_,{className:"w-5 h-5"}),"Mark as Resolved"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex gap-3 mb-6 overflow-x-auto pb-2",children:["","open","in_progress","resolved"].map(s=>e.jsx("button",{onClick:()=>N(s),className:`px-4 py-2 rounded-xl font-bold text-sm whitespace-nowrap transition-all ${m===s?"bg-teal-500 text-black":"bg-zinc-900/50 text-gray-400 border border-white/10 hover:border-white/20"}`,children:s===""?"All":s.replace("_"," ").toUpperCase()},s))}),e.jsx("div",{className:"space-y-4",children:n?e.jsx("div",{className:"text-center py-20 text-zinc-500",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-teal-500 mx-auto"})}):r.length===0?e.jsxs("div",{className:"text-center py-20 bg-zinc-900/50 rounded-xl border border-white/5",children:[e.jsx(C,{className:"w-10 h-10 mx-auto text-zinc-600 mb-2"}),e.jsx("p",{className:"text-zinc-400",children:"No reports found"})]}):r.map(s=>e.jsx(k.div,{whileHover:{y:-2},onClick:()=>i(s),className:"bg-zinc-900/50 border border-white/5 p-5 rounded-xl hover:border-white/10 transition-all cursor-pointer",children:e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:`px-3 py-1 text-xs font-bold rounded-full border ${j(s.status)}`,children:s.status.toUpperCase()}),e.jsx("span",{className:"text-xs text-zinc-500",children:w(s.issueType)})]}),e.jsx("h3",{className:"font-bold text-lg mb-1",children:s.subject}),e.jsxs("p",{className:"text-sm text-zinc-400",children:[s.tournamentId?.title||"Tournament"," • ",s.playerName]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-zinc-500 mb-2",children:[e.jsx(F,{className:"w-3 h-3"}),new Date(s.createdAt).toLocaleDateString()]}),e.jsxs("div",{className:"text-xs text-zinc-600",children:[s.messages?.length||0," messages"]})]})]})},s._id))})]})]})})};export{U as default};
