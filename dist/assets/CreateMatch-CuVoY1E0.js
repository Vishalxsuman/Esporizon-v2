import{u as L,j as e,i as N,z as h}from"./index-BI1Zh8jC.js";import{d as M,f as A,r as n}from"./react-vendor-wpuS94OW.js";import{m as B}from"./MatchService-Cgm4VoCI.js";import{f as i,i as l}from"./espoCoin-BtHhLzJX.js";import{A as W}from"./arrow-left-CF79Ni4S.js";import{G as z}from"./globe-go4E1SxS.js";import{L as G}from"./lock-Cscx1y43.js";import{U as T}from"./users-Doj8e7tS.js";import"./animation-vendor-DcM-v-LS.js";const H=()=>{const p=M(),{user:r}=L(),[v]=A(),d=v.get("game")||"chess",a=v.get("mode")||"free",[c,w]=n.useState(null),[m,f]=n.useState("public"),[j,C]=n.useState(!1),[t,k]=n.useState(0),[u,P]=n.useState(600),[y,b]=n.useState(!1),g=d==="chess"?"Chess":"29 Card Game",x=d==="chess"?2:4,E=[10,50,100,500];n.useEffect(()=>{if(!r)return;(async()=>{const o=await N.getWallet(r.id);w(o)})()},[r]);const F=async()=>{if(r){b(!0);try{const s=a==="paid"?l(t):0;if(a==="paid"&&c&&c.espoCoins<s){h.error("Insufficient Espo Coins!"),b(!1);return}a==="paid"&&s>0&&await N.deductEspoCoins(s,r.id,`Entry fee for ${g} match`,{matchType:a});const o=await B.createMatch({gameId:d,mode:a,visibility:m,entryFee:s,maxPlayers:x,withBots:j,timeControl:u},r.id,r.displayName||"Player",r.photoURL||"");h.success("Match created!"),p(`/play/match/${o.id}`)}catch(s){h.error(s instanceof Error?s.message:"Failed to create match")}finally{b(!1)}}},S=()=>{const o=l(t)*x,$=o*.1;return o-$};return e.jsx("div",{className:"min-h-screen bg-[var(--bg-primary)] text-[var(--text-primary)] pb-24 lg:pb-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("button",{onClick:()=>p("/play"),className:"flex items-center gap-2 text-[var(--text-secondary)] hover:text-[var(--text-primary)] mb-4",children:[e.jsx(W,{className:"w-5 h-5"}),"Back to Play"]}),e.jsx("h1",{className:"text-3xl font-black mb-2",children:"Create Match"}),e.jsxs("p",{className:"text-[var(--text-secondary)]",children:[g," â€¢ ",a==="free"?"Free Play":"Paid Play"]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-3",children:"Match Visibility"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>f("public"),className:`p-4 rounded-xl border-2 transition-all ${m==="public"?"border-[var(--accent)] bg-[var(--accent)]/10":"border-[var(--border)] hover:border-[var(--accent)]/30"}`,children:[e.jsx(z,{className:"w-6 h-6 mb-2 mx-auto"}),e.jsx("p",{className:"font-bold text-sm",children:"Public Lobby"}),e.jsx("p",{className:"text-xs text-[var(--text-secondary)] mt-1",children:"Anyone can join"})]}),e.jsxs("button",{onClick:()=>f("private"),className:`p-4 rounded-xl border-2 transition-all ${m==="private"?"border-[var(--accent)] bg-[var(--accent)]/10":"border-[var(--border)] hover:border-[var(--accent)]/30"}`,children:[e.jsx(G,{className:"w-6 h-6 mb-2 mx-auto"}),e.jsx("p",{className:"font-bold text-sm",children:"Private Invite"}),e.jsx("p",{className:"text-xs text-[var(--text-secondary)] mt-1",children:"Share link to invite"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-3",children:"Time Control"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:[300,600,1800,3600].map(s=>e.jsxs("button",{onClick:()=>P(s),className:`p-3 rounded-xl border transition-all text-sm font-bold ${u===s?"border-[var(--accent)] bg-[var(--accent)]/10 text-[var(--accent)]":"border-[var(--border)] hover:border-[var(--accent)]/30"}`,children:[s/60,"m"]},s))})]})]}),a==="free"&&e.jsx("div",{className:"p-4 bg-[var(--glass)] rounded-lg border border-[var(--border)]",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-bold flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:"ðŸ¤–"}),d==="chess"?"Play vs Computer":"Allow Bots"]}),e.jsx("p",{className:"text-sm text-[var(--text-secondary)] mt-1",children:d==="chess"?"Challenge our chess engine":"Fill empty slots with bots"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:j,onChange:s=>C(s.target.checked)}),e.jsx("div",{className:"w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-[var(--accent)]"})]})]})}),a==="paid"&&e.jsxs("div",{className:"p-4 bg-yellow-500/10 border border-yellow-500/30 rounded-lg flex items-start gap-3 mb-6",children:[e.jsx("span",{className:"text-xl",children:"âš ï¸"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-yellow-400",children:"Real Players Only"}),e.jsx("p",{className:"text-xs text-[var(--text-secondary)] mt-1",children:"Bots are strictly forbidden in paid matches."})]})]}),a==="paid"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-3",children:"Entry Amount"}),e.jsx("div",{className:"grid grid-cols-4 gap-2 mb-3",children:E.map(s=>e.jsxs("button",{onClick:()=>k(s),className:`py-3 rounded-lg font-bold transition-all ${t===s?"bg-[var(--accent)] text-[var(--bg-primary)]":"bg-[var(--glass)] border border-[var(--border)] hover:border-[var(--accent)]"}`,children:["â‚¹",s]},s))}),e.jsxs("div",{className:"p-4 bg-[var(--glass)] rounded-lg border border-[var(--border)]",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-[var(--text-secondary)]",children:"Entry Fee (You)"}),e.jsx("span",{className:"font-bold",children:i(l(t))})]}),e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-[var(--text-secondary)]",children:"Prize Pool"}),e.jsx("span",{className:"font-bold",children:i(l(t)*x)})]}),e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-[var(--text-secondary)]",children:"Platform Fee (10%)"}),e.jsxs("span",{className:"font-bold text-red-400",children:["-",i(l(t)*x*.1)]})]}),e.jsx("div",{className:"border-t border-[var(--border)] mt-2 pt-2",children:e.jsxs("div",{className:"flex justify-between text-base",children:[e.jsx("span",{className:"font-bold",children:"Winner Gets"}),e.jsx("span",{className:"font-black text-[var(--accent)]",children:i(S())})]})})]}),c&&e.jsxs("div",{className:"mt-3 p-3 bg-[var(--glass)] rounded-lg border border-[var(--border)] flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-[var(--text-secondary)]",children:"Your Balance"}),e.jsx("span",{className:`font-bold ${c.espoCoins>=l(t)?"text-[var(--accent)]":"text-red-400"}`,children:i(c.espoCoins)})]})]}),e.jsxs("div",{className:"p-4 bg-[var(--glass)] rounded-lg border border-[var(--border)]",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(T,{className:"w-4 h-4 text-[var(--text-secondary)]"}),e.jsx("span",{className:"text-sm text-[var(--text-secondary)]",children:"Players"})]}),e.jsxs("p",{className:"font-bold",children:[x," Players"]})]}),e.jsx("button",{onClick:F,disabled:y||a==="paid"&&(t===0||!c||c.espoCoins<l(t)),className:"w-full py-4 bg-[var(--accent)] text-[var(--bg-primary)] font-black rounded-xl hover:bg-[var(--accent)]/90 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-[0_0_30px_rgba(0,255,194,0.3)]",children:y?"Creating...":a==="paid"?`Lock ${i(l(t))} & Create Match`:"Create Free Match"})]})})};export{H as default};
