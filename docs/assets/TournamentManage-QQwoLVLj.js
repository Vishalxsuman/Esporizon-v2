import{u as L,j as e,T as k}from"./index-BI1Zh8jC.js";import{d as T,r}from"./react-vendor-wpuS94OW.js";import{t as f}from"./TournamentService-C6zcdh7M.js";import{T as I}from"./TournamentChatRoom-qCWcG3Zr.js";import{A as R}from"./arrow-left-CF79Ni4S.js";import{S as P}from"./save-CazO1OzS.js";import{L as z}from"./loader-circle-DGd37Dy2.js";import"./animation-vendor-DcM-v-LS.js";import"./message-square-BC04dgYS.js";import"./users-Doj8e7tS.js";import"./shield-UrmeYB5b.js";import"./send-BLDoqAZd.js";const M=({tournamentId:p,initialData:n})=>{const[m,i]=r.useState(n?.roomId||""),[x,c]=r.useState(n?.password||""),[s,h]=r.useState(n?.server||"India"),[o,v]=r.useState(n?.map||""),[g,d]=r.useState(!1),N=async()=>{d(!0);try{await f.updateRoomDetails(p,{roomId:m,password:x,server:s,map:o}),alert("Room details updated & posted to chat!")}catch{alert("Failed to update room details")}finally{d(!1)}};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{placeholder:"Room ID",value:m,onChange:l=>i(l.target.value),className:"bg-black/50 border border-zinc-700 rounded-lg px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none"}),e.jsx("input",{placeholder:"Password",value:x,onChange:l=>c(l.target.value),className:"bg-black/50 border border-zinc-700 rounded-lg px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("input",{placeholder:"Server (e.g. India)",value:s,onChange:l=>h(l.target.value),className:"bg-black/50 border border-zinc-700 rounded-lg px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none"}),e.jsx("input",{placeholder:"Map (e.g. Bermuda)",value:o,onChange:l=>v(l.target.value),className:"bg-black/50 border border-zinc-700 rounded-lg px-3 py-2 text-sm text-white focus:border-indigo-500 outline-none"})]}),e.jsx("button",{onClick:N,disabled:g,className:"w-full py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg text-xs font-bold uppercase tracking-wider transition-colors disabled:opacity-50",children:g?"Updating...":"Update & Post to Chat"})]})},U=({tournamentId:p,initialData:n,onUpdate:m})=>{const[i,x]=r.useState(n?.status==="live"),[c,s]=r.useState(n?.youtubeUrl||""),[h,o]=r.useState(!1);r.useEffect(()=>{x(n?.status==="live"),s(n?.youtubeUrl||"")},[n]);const v=async()=>{if(i){if(!c.includes("youtube.com")&&!c.includes("youtu.be")){alert("Invalid YouTube URL");return}o(!0);try{await f.updateLiveStream(p,{isLive:!0,youtubeUrl:c}),alert("Live stream updated successfully!"),m?.()}catch{alert("Failed to update live stream")}finally{o(!1)}}},g=async()=>{if(confirm("Stop live stream? This will mark existing stream as ended.")){o(!0);try{await f.updateLiveStream(p,{isLive:!1}),x(!1),s(""),alert("Stream stopped"),m?.()}catch{alert("Failed to stop stream")}finally{o(!1)}}};return e.jsxs("div",{className:"bg-zinc-900/40 border border-white/5 rounded-xl p-5 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-red-500/20 flex items-center justify-center",children:e.jsx("div",{className:`w-2 h-2 rounded-full ${i?"bg-red-500 animate-pulse":"bg-red-500/50"}`})}),e.jsx("h3",{className:"font-bold text-lg",children:"Live Stream"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-zinc-500 uppercase font-black tracking-wider",children:i?"LIVE":"OFFLINE"}),e.jsx("button",{onClick:()=>i?g():x(!0),className:`w-10 h-5 rounded-full transition-colors relative flex items-center px-1 ${i?"bg-red-500":"bg-zinc-700"}`,children:e.jsx("div",{className:`w-3 h-3 bg-white rounded-full transition-transform ${i?"translate-x-5":"translate-x-0"}`})})]})]}),i&&e.jsxs("div",{className:"space-y-3 animate-fadeIn",children:[e.jsx("input",{placeholder:"https://youtube.com/live/...",value:c,onChange:d=>s(d.target.value),className:"w-full bg-black/50 border border-zinc-700 rounded-lg px-3 py-2 text-sm text-white focus:border-red-500 outline-none placeholder:text-zinc-600"}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:v,disabled:h,className:"flex-1 py-2 bg-white text-black hover:bg-zinc-200 rounded-lg text-xs font-bold uppercase tracking-wider transition-colors disabled:opacity-50",children:h?"Saving...":"Update Stream"})})]})]})},G=()=>{const p=T(),{user:n}=L(),[m,i]=r.useState([]),[x,c]=r.useState(!0),[s,h]=r.useState(null),[o,v]=r.useState([]),[g,d]=r.useState(!1),[N,l]=r.useState({}),[y,w]=r.useState(!1);r.useEffect(()=>{(async()=>{if(n)try{c(!0);const a=await f.getOrganizerTournaments(n.id);i(a)}catch{}finally{c(!1)}})()},[n]);const S=async t=>{h(t),l({});try{d(!0);const a=await f.getParticipants(t.id);v(a);const j={};a.forEach(b=>{const u=b.players[0];u&&(j[b.id]={rank:"",kills:"0",userId:u.userId,userName:u.userName,teamName:b.teamName})}),l(j)}catch{}finally{d(!1)}},C=async()=>{if(s&&confirm("Are you sure you want to publish these results? This action handles payouts and cannot be undone."))try{w(!0);const t=Object.values(N).filter(a=>a.rank&&Number(a.rank)>0).map(a=>({userId:a.userId,kills:Number(a.kills),rank:Number(a.rank),teamName:a.teamName||a.userName}));await f.publishResults(s.id,t),alert("Results published successfully!"),h(null),window.location.reload()}catch(t){alert(t.message)}finally{w(!1)}};return e.jsx("div",{className:"min-h-screen bg-black text-white p-6 font-sans",children:e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("button",{onClick:()=>p(-1),className:"p-2 bg-zinc-900 rounded-full hover:bg-zinc-800",children:e.jsx(R,{className:"w-5 h-5 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-black italic uppercase",children:"Manage Tournaments"}),e.jsx("p",{className:"text-zinc-500 text-sm",children:"Host Console"})]})]}),s?e.jsxs("div",{className:"animate-fadeIn space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between bg-zinc-900/80 p-4 rounded-xl border border-white/10",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-xl",children:s.title}),e.jsx("p",{className:"text-zinc-400 text-xs",children:"Manage tournament details, room info, and results."})]}),e.jsx("button",{onClick:()=>h(null),className:"text-zinc-500 hover:text-white text-xs font-bold uppercase",children:" Cancel "})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(U,{tournamentId:s.id,initialData:s,onUpdate:()=>{}}),e.jsxs("div",{className:"bg-zinc-900/40 border border-white/5 rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-indigo-500/20 flex items-center justify-center",children:e.jsx(P,{className:"w-4 h-4 text-indigo-400"})}),e.jsx("h3",{className:"font-bold text-lg",children:"Room Details"})]}),e.jsx(M,{tournamentId:s.id,initialData:s.roomDetails})]}),e.jsx("div",{className:"h-[500px]",children:e.jsx(I,{tournamentId:s.id,tournamentName:s.title,isAdmin:!0})})]}),e.jsx("div",{children:e.jsxs("div",{className:"bg-zinc-900/40 border border-white/5 rounded-xl overflow-hidden",children:[e.jsx("div",{className:"p-4 bg-zinc-950/50 border-b border-white/5",children:e.jsx("h3",{className:"font-bold text-lg",children:"Results & Standings"})}),g?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx(z,{className:"w-8 h-8 animate-spin text-teal-500"})}):o.length===0?e.jsx("div",{className:"text-center py-20 text-zinc-500",children:"No participants joined this tournament."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 border-b border-white/5 grid grid-cols-12 gap-2 text-[10px] font-bold text-zinc-500 uppercase tracking-wider",children:[e.jsx("div",{className:"col-span-1",children:"#"}),e.jsx("div",{className:"col-span-5",children:"Team / Player"}),e.jsx("div",{className:"col-span-3 text-center",children:"Rank"}),e.jsx("div",{className:"col-span-3 text-center",children:"Kills"})]}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:o.map((t,a)=>{const j=N[t.id]||{};return e.jsxs("div",{className:"p-3 border-b border-white/5 grid grid-cols-12 gap-2 items-center hover:bg-white/5 transition-colors",children:[e.jsx("div",{className:"col-span-1 text-zinc-500 text-xs",children:a+1}),e.jsxs("div",{className:"col-span-5",children:[e.jsx("div",{className:"font-medium text-white text-sm truncate",children:t.teamName||"Solo"}),e.jsx("div",{className:"text-zinc-500 text-[10px] truncate",children:t.players[0]?.userName})]}),e.jsx("div",{className:"col-span-3",children:e.jsx("input",{type:"number",placeholder:"-",className:"w-full bg-black/50 border border-zinc-700 rounded px-2 py-1 text-center font-mono focus:border-teal-500 outline-none hover:border-zinc-500 transition-colors",value:j.rank||"",onChange:b=>l(u=>({...u,[t.id]:{...u[t.id],rank:b.target.value}}))})}),e.jsx("div",{className:"col-span-3",children:e.jsx("input",{type:"number",placeholder:"-",className:"w-full bg-black/50 border border-zinc-700 rounded px-2 py-1 text-center font-mono focus:border-teal-500 outline-none hover:border-zinc-500 transition-colors",value:j.kills||"",onChange:b=>l(u=>({...u,[t.id]:{...u[t.id],kills:b.target.value}}))})})]},t.id)})}),e.jsx("div",{className:"p-4 bg-zinc-950 border-t border-white/10 flex justify-end",children:e.jsxs("button",{onClick:C,disabled:y,className:"w-full py-4 bg-teal-500 hover:bg-teal-400 text-black font-black uppercase tracking-wider rounded-xl transition-all disabled:opacity-50 flex items-center justify-center gap-2",children:[y?e.jsx(z,{className:"w-4 h-4 animate-spin"}):e.jsx(k,{className:"w-4 h-4"}),"Publish Results"]})})]})]})})]})]}):e.jsx("div",{className:"grid gap-4",children:x?e.jsx("div",{className:"text-center py-20 text-zinc-500",children:"Loading your tournaments..."}):m.length===0?e.jsxs("div",{className:"text-center py-20 bg-zinc-900/50 rounded-xl border border-white/5",children:[e.jsx(k,{className:"w-10 h-10 mx-auto text-zinc-600 mb-2"}),e.jsx("p",{className:"text-zinc-400",children:"You haven't hosted any tournaments yet."}),e.jsx("button",{onClick:()=>p("/arena/freefire"),className:"mt-4 text-teal-500 font-bold text-sm",children:"Create One"})]}):m.map(t=>e.jsxs("div",{className:"bg-zinc-900/50 border border-white/5 p-5 rounded-xl flex items-center justify-between hover:border-white/10 transition-colors",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`px-2 py-0.5 text-[10px] font-bold uppercase rounded border ${t.status==="completed"?"text-zinc-500 border-zinc-700":t.status==="upcoming"?"text-teal-500 border-teal-500/30":"text-amber-500 border-amber-500/30"}`,children:t.status}),e.jsx("span",{className:"text-zinc-500 text-xs",children:new Date(t.startDate).toLocaleDateString()})]}),e.jsx("h3",{className:"font-bold text-lg",children:t.title}),e.jsxs("div",{className:"text-xs text-zinc-400 mt-1",children:[t.currentTeams," / ",t.maxTeams," Teams • Prize Pool: ₹",t.prizePool]})]}),t.status!=="completed"&&e.jsx("button",{onClick:()=>S(t),className:"px-4 py-2 bg-zinc-800 hover:bg-teal-600 hover:text-white text-zinc-300 rounded-lg text-xs font-black uppercase tracking-wider transition-colors",children:"Manage Results"})]},t.id))})]})})};export{G as default};
