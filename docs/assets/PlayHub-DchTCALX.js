import{c as M,a as _,g as O,q as U,w as C,o as F,l as $,b as q,e as H,d as D,m as T,p as B,u as J,j as e,i as Y,z as P}from"./index-BI1Zh8jC.js";import{d as V,r as u}from"./react-vendor-wpuS94OW.js";import{m as k}from"./MatchService-Cgm4VoCI.js";import{f as Z}from"./espoCoin-BtHhLzJX.js";import{P as K}from"./ParticlesBackground-NSX_nVyZ.js";import{Z as X}from"./zap-Bgyi282r.js";import{U as Q}from"./users-Doj8e7tS.js";import{C as ee}from"./crown-jJBmEEOr.js";import{A as ae,m as b}from"./animation-vendor-DcM-v-LS.js";import{X as te}from"./x-TGG6ZPAc.js";import{G as re}from"./gamepad-2-nPqXZvCW.js";import{A as se}from"./arrow-right-CJAg3w6b.js";import{T as ne}from"./trending-up-uCxCWmjX.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],ie=M("sparkles",oe);class ce{leaderboardsCollection=_(O(),"leaderboards");async getLeaderboard(c){try{const r=U(this.leaderboardsCollection,C("type","==",c),C("period","==","weekly"),F("createdAt","desc"),$(1)),s=await q(r);if(s.empty)return await this.createLeaderboard(c);const t=s.docs[0];return{id:t.id,...t.data()}}catch{return null}}async getUserRank(c,r){try{const s=await this.getLeaderboard(r);if(!s)return null;const t=s.entries.find(l=>l.userId===c);return t?t.rank:null}catch{return null}}async updateLeaderboardEntry(c,r,s,t,l){try{const n=await this.getLeaderboard(t);if(!n)return;const g=H(this.leaderboardsCollection,n.id),f=n.entries.findIndex(x=>x.userId===c);if(f>=0){const x=n.entries[f];x.gamesPlayed+=l.gamesPlayed||0,x.gamesWon+=l.gamesWon||0,x.totalEarnings+=l.earnings||0,n.entries.sort((o,i)=>t==="top_earners"?i.totalEarnings-o.totalEarnings:i.gamesWon-o.gamesWon),n.entries.forEach((o,i)=>{o.rank=i+1,i===0?o.badge="gold":i===1?o.badge="silver":i===2?o.badge="bronze":delete o.badge}),await D(g,{entries:n.entries})}else{const x={userId:c,userName:r,userAvatar:s,gamesPlayed:l.gamesPlayed||0,gamesWon:l.gamesWon||0,totalEarnings:l.earnings||0,rank:n.entries.length+1};n.entries.push(x),n.entries.sort((o,i)=>t==="top_earners"?i.totalEarnings-o.totalEarnings:i.gamesWon-o.gamesWon),n.entries.forEach((o,i)=>{o.rank=i+1,i===0?o.badge="gold":i===1?o.badge="silver":i===2?o.badge="bronze":delete o.badge}),await D(g,{entries:n.entries})}}catch{throw new Error("Failed to update leaderboard")}}async createLeaderboard(c){const r=new Date,s=this.getWeekStart(r),t=new Date(s);t.setDate(t.getDate()+7);const l=new Date(t),n={type:c,period:"weekly",weekStartDate:s.toISOString(),weekEndDate:t.toISOString(),entries:[],resetAt:l.toISOString(),createdAt:r.toISOString()},g=await T(this.leaderboardsCollection,{...n,createdAt:B(),resetAt:l});return{...n,id:g.id}}getWeekStart(c){const r=new Date(c),s=r.getDay(),t=r.getDate()-s+(s===0?-6:1),l=new Date(r.setDate(t));return l.setHours(0,0,0,0),l}async checkAndResetLeaderboards(){try{const c=["overall_champions","free_masters","top_earners"];for(const r of c){const s=await this.getLeaderboard(r);if(!s)continue;const t=new Date(s.resetAt);new Date>=t&&await this.createLeaderboard(r)}}catch{}}}const le=new ce,Ne=()=>{const{user:m}=J(),c=V(),[r,s]=u.useState(null),[t,l]=u.useState(0),[n,g]=u.useState(null),[f,x]=u.useState(!0),[o,i]=u.useState(!1),[w,A]=u.useState(""),[S,L]=u.useState(null),[N,j]=u.useState(!1);u.useEffect(()=>{(async()=>{if(m)try{const d=await Y.getWallet(m.id);s(d);const p=await k.getUserMatches(m.id);l(p.length);const v=await le.getUserRank(m.id,"overall_champions");g(v)}catch{}x(!1)})()},[m]);const I=()=>{const a=localStorage.getItem("guest_identity");return a?JSON.parse(a):null},R=a=>{const d={id:`guest_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,name:a,avatar:`https://api.dicebear.com/7.x/avataaars/svg?seed=${a}`};return localStorage.setItem("guest_identity",JSON.stringify(d)),d},h=async(a,d)=>{j(!0);try{const p=m?{id:m.id||m.uid||"unknown",name:m.displayName||"Player",avatar:m.photoURL}:d||I();if(!p){L(a),i(!0),j(!1);return}if(a.type==="create"){const{gameId:v,mode:y}=a.data;if(y==="paid"&&!m){P.error("Guests can only play Free matches. Please login to play Paid."),j(!1);return}const z=await k.createMatch({gameId:v,mode:y,maxPlayers:v==="chess"?2:4,entryFee:y==="paid"?10:0,visibility:"private",withBots:!1},p.id,p.name,p.avatar);c(`/play/match/${z.id}`)}else if(a.type==="join"){const{code:v}=a.data,y=await k.joinRoom(v,p);c(`/play/match/${y.id}`)}else a.type==="navigate"&&c(a.data.route)}catch(p){P.error(p.message||"Action failed")}finally{j(!1),i(!1)}},E=()=>{if(!w.trim())return;const a=R(w);S&&h(S,a)},G=[{id:"chess",name:"Online Chess",icon:"â™Ÿï¸",players:2,desc:"Classic Strategy",gradient:"from-purple-500/20 to-indigo-500/20",accentColor:"purple-500"},{id:"card29",name:"29 Card Game",icon:"ðŸƒ",players:4,desc:"Team Multiplayer",gradient:"from-rose-500/20 to-pink-500/20",accentColor:"rose-500"}],W=[{label:"Espo Coins",value:r?Z(r.espoCoins):"0 EC",icon:X,color:"text-yellow-400"},{label:"Active Matches",value:t,icon:Q,color:"text-blue-400"},{label:"Rank",value:n?`#${n}`:"N/A",icon:ee,color:"text-[var(--accent)]"}];return f?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[var(--bg-primary)]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-[var(--accent)]/10 border-t-[var(--accent)] rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-[var(--accent)] font-bold",children:"Loading PlayHub..."})]})}):e.jsxs("div",{className:"min-h-screen bg-[var(--bg-primary)] text-[var(--text-primary)] pb-24 relative overflow-hidden transition-colors duration-300",children:[e.jsx(K,{}),e.jsxs("div",{className:"fixed inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute top-0 right-0 w-[600px] h-[600px] bg-[var(--accent)]/5 blur-[150px] opacity-40"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-[500px] h-[500px] bg-purple-500/5 blur-[140px] opacity-30"})]}),e.jsx(ae,{children:o&&e.jsx(b.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:e.jsxs(b.div,{initial:{scale:.9},animate:{scale:1},exit:{scale:.9},className:"bg-[var(--card-bg)] w-full max-w-md p-6 rounded-2xl border border-[var(--card-border)] shadow-2xl backdrop-blur-xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-[var(--text-primary)]",children:"Enter Guest Name"}),e.jsx("button",{onClick:()=>i(!1),className:"p-2 hover:bg-[var(--surface-hover)] rounded-lg transition-colors",children:e.jsx(te,{className:"text-[var(--text-secondary)] hover:text-[var(--text-primary)]",size:20})})]}),e.jsx("input",{type:"text",value:w,onChange:a=>A(a.target.value),placeholder:"Your Display Name...",className:"w-full bg-[var(--input-bg)] border border-[var(--input-border)] rounded-xl px-4 py-3 text-[var(--text-primary)] placeholder-[var(--text-secondary)] mb-6 focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20 outline-none transition-all select-text",autoFocus:!0,onKeyPress:a=>a.key==="Enter"&&E()}),e.jsx("button",{onClick:E,disabled:!w.trim()||N,className:"w-full bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-black py-3 rounded-xl font-bold transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-[var(--accent)]/50",children:N?"Processing...":"Continue as Guest"})]})})}),e.jsxs("div",{className:"relative pt-16 sm:pt-24 pb-8 sm:pb-12 px-4 text-center",children:[e.jsxs(b.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},className:"inline-flex items-center gap-2 px-4 py-2 bg-[var(--accent-muted)] border border-[var(--accent)]/20 rounded-full mb-6",children:[e.jsx(ie,{className:"text-[var(--accent)]",size:16}),e.jsx("span",{className:"text-xs font-bold text-[var(--accent)] uppercase tracking-wider",children:"Play & Earn Rewards"})]}),e.jsxs(b.h1,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},className:"text-4xl sm:text-5xl md:text-6xl font-black mb-4 tracking-tight",children:[e.jsx("span",{className:"text-[var(--text-primary)]",children:"PLAY"}),e.jsx("span",{className:"text-[var(--accent)] italic",children:" HUB"}),e.jsx("span",{className:"text-[var(--accent)]",children:"."})]}),e.jsxs(b.p,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"text-[var(--text-secondary)] text-base sm:text-lg max-w-2xl mx-auto mb-8 leading-relaxed",children:["Challenge players worldwide. ",e.jsx("span",{className:"text-[var(--accent)] font-semibold",children:"No login needed"})," for free games."]}),m&&e.jsx(b.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3},className:"flex justify-center gap-3 sm:gap-4 flex-wrap mb-8",children:W.map((a,d)=>e.jsxs("div",{className:"bg-[var(--card-bg)] border border-[var(--card-border)] rounded-xl p-3 sm:p-4 flex items-center gap-3 backdrop-blur-xl hover:border-[var(--accent)]/30 transition-all group",children:[e.jsx("div",{className:`p-2 rounded-lg bg-[var(--surface)] ${a.color} group-hover:scale-110 transition-transform`,children:e.jsx(a.icon,{size:18})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-[10px] text-[var(--text-secondary)] uppercase tracking-wider font-bold",children:a.label}),e.jsx("div",{className:"font-black text-sm text-[var(--text-primary)]",children:a.value})]})]},d))})]}),e.jsx("div",{className:"max-w-xl mx-auto px-4 mb-12 sm:mb-16",children:e.jsxs(b.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4},className:"relative group",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-[var(--accent)]/20 to-purple-500/20 rounded-2xl blur-xl opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative bg-[var(--card-bg)] border border-[var(--card-border)] rounded-2xl p-5 sm:p-6 backdrop-blur-xl",children:[e.jsxs("label",{className:"flex items-center gap-2 text-xs font-bold text-[var(--accent)] uppercase tracking-widest mb-4",children:[e.jsx(re,{size:14}),"Have a Room Code?"]}),e.jsxs("form",{onSubmit:a=>{a.preventDefault();const d=a.target.code.value;d&&h({type:"join",data:{code:d}})},className:"flex gap-2 sm:gap-3",children:[e.jsx("input",{name:"code",type:"text",placeholder:"ENTER-CODE",className:"flex-1 bg-[var(--input-bg)] border border-[var(--input-border)] rounded-xl px-4 py-3 font-mono text-center tracking-widest uppercase text-[var(--text-primary)] placeholder-[var(--text-secondary)] focus:border-[var(--accent)] focus:ring-2 focus:ring-[var(--accent)]/20 outline-none transition-all select-text",maxLength:10}),e.jsxs("button",{type:"submit",disabled:N,className:"bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-black font-bold px-6 sm:px-8 py-3 rounded-xl transition-all shadow-lg hover:shadow-[var(--accent)]/50 disabled:opacity-50 flex items-center gap-2 hover:scale-105 active:scale-95",children:["JOIN",e.jsx(se,{size:16})]})]})]})]})}),e.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-xl sm:text-2xl font-black text-[var(--text-primary)] flex items-center gap-3",children:[e.jsx("span",{className:"w-1.5 h-8 bg-[var(--accent)] rounded-full"}),"Available Games"]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold text-[var(--text-secondary)]",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),"3 LIVE"]})]}),e.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:G.map((a,d)=>e.jsxs(b.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5+d*.1},className:"relative group",children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${a.gradient} rounded-2xl blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-500`}),e.jsxs("div",{className:"relative bg-[var(--card-bg)] border border-[var(--card-border)] rounded-2xl p-6 hover:border-[var(--accent)]/40 transition-all backdrop-blur-xl group-hover:transform group-hover:scale-[1.02] duration-300",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx("div",{className:"text-5xl flex items-center justify-center h-[56px] w-[56px] bg-[var(--surface)] rounded-xl border border-[var(--border)] group-hover:scale-110 transition-transform",children:a.icon}),e.jsxs("div",{className:"px-3 py-1 rounded-full bg-green-500/10 border border-green-500/20 text-green-400 text-[10px] font-bold flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"}),"LIVE"]})]}),e.jsx("h3",{className:"text-xl font-bold mb-2 text-[var(--text-primary)] group-hover:text-[var(--accent)] transition-colors",children:a.name}),e.jsxs("p",{className:"text-sm text-[var(--text-secondary)] mb-6 flex items-center gap-2",children:[a.desc,e.jsx("span",{className:"text-[var(--accent)]",children:"â€¢"}),e.jsx("span",{className:"font-bold text-[var(--accent)]",children:a.players})," Players"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:a.id==="prediction"?e.jsxs("button",{onClick:()=>h({type:"navigate",data:{route:"/predict"}}),className:"col-span-2 py-3 rounded-xl bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-black font-bold shadow-lg hover:shadow-[var(--accent)]/50 transition-all flex items-center justify-center gap-2 group/btn",children:["PLAY NOW",e.jsx(ne,{size:16,className:"group-hover/btn:translate-x-1 transition-transform"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>h({type:"create",data:{gameId:a.id,mode:"free"}}),className:"py-3 rounded-xl bg-[var(--surface)] hover:bg-[var(--surface-hover)] border border-[var(--border)] font-bold text-sm text-[var(--text-primary)] transition-all hover:border-[var(--accent)]/40",children:"Free"}),e.jsx("button",{onClick:()=>h({type:"create",data:{gameId:a.id,mode:"paid"}}),className:"py-3 rounded-xl bg-[var(--accent)] hover:bg-[var(--accent-hover)] text-black font-bold shadow-lg hover:shadow-[var(--accent)]/50 transition-all text-sm",children:"Paid"})]})})]})]},a.id))})]}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 mt-16 text-center",children:e.jsx("p",{className:"text-xs text-[var(--text-secondary)] italic",children:"Free games don't require login. Paid games require authentication for secure transactions."})})]})};export{Ne as default};
